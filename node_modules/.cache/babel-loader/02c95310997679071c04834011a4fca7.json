{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useContext } from 'react';\nimport { AuthContext } from '../context/AuthContext';\n\nconst useRefreshToken = () => {\n  _s();\n\n  const {\n    userAuth,\n    setUserAuth,\n    logout\n  } = useContext(AuthContext);\n  const baseURL = \"http://localhost:8080/api\";\n  const refreshURL = `${baseURL}/users/token/refresh`;\n  const config = {\n    headers: {\n      'Authorization': `Bearer ${userAuth.refreshToken}`\n    }\n  };\n\n  const refresh = async () => {\n    try {\n      const response = await axios.get(refreshURL, config);\n      window.localStorage.setItem(\"access_token\", response.data.access_token);\n      setUserAuth(prevState => ({\n        username: prevState.username,\n        accessToken: response.data.access_token,\n        refreshToken: prevState.refreshToken\n      }));\n      return response.data.access_token;\n    } catch (error) {\n      console.log(`Error: ${error.response.data.error_message}`);\n      logout();\n      throw error;\n    }\n  };\n\n  return refresh;\n};\n\n_s(useRefreshToken, \"/z3PSR2TKasLx8RMyAkE/tSL3qw=\");\n\nexport default useRefreshToken;","map":{"version":3,"sources":["/Users/agusespa/Programming/Projects/self-okrs-ui/src/utils/useRefreshToken.js"],"names":["axios","useContext","AuthContext","useRefreshToken","userAuth","setUserAuth","logout","baseURL","refreshURL","config","headers","refreshToken","refresh","response","get","window","localStorage","setItem","data","access_token","prevState","username","accessToken","error","console","log","error_message"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,OAA3B;AACA,SAASC,WAAT,QAA4B,wBAA5B;;AAEA,MAAMC,eAAe,GAAG,MAAM;AAAA;;AAE7B,QAAM;AAAEC,IAAAA,QAAF;AAAYC,IAAAA,WAAZ;AAAyBC,IAAAA;AAAzB,MAAoCL,UAAU,CAACC,WAAD,CAApD;AAEA,QAAMK,OAAO,GAAG,2BAAhB;AACA,QAAMC,UAAU,GAAI,GAAED,OAAQ,sBAA9B;AAEA,QAAME,MAAM,GAAG;AACdC,IAAAA,OAAO,EAAE;AACR,uBAAkB,UAASN,QAAQ,CAACO,YAAa;AADzC;AADK,GAAf;;AAMA,QAAMC,OAAO,GAAG,YAAY;AAE3B,QAAI;AAEH,YAAMC,QAAQ,GAAG,MAAMb,KAAK,CAACc,GAAN,CAAUN,UAAV,EAAsBC,MAAtB,CAAvB;AAEAM,MAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,EAA4CJ,QAAQ,CAACK,IAAT,CAAcC,YAA1D;AAEAd,MAAAA,WAAW,CAACe,SAAS,KAAM;AAC1BC,QAAAA,QAAQ,EAAED,SAAS,CAACC,QADM;AAE1BC,QAAAA,WAAW,EAAET,QAAQ,CAACK,IAAT,CAAcC,YAFD;AAG1BR,QAAAA,YAAY,EAAES,SAAS,CAACT;AAHE,OAAN,CAAV,CAAX;AAMA,aAAOE,QAAQ,CAACK,IAAT,CAAcC,YAArB;AAEA,KAdD,CAcE,OAAOI,KAAP,EAAc;AACfC,MAAAA,OAAO,CAACC,GAAR,CAAa,UAASF,KAAK,CAACV,QAAN,CAAeK,IAAf,CAAoBQ,aAAc,EAAxD;AACApB,MAAAA,MAAM;AACN,YAAMiB,KAAN;AAEA;AACD,GAtBD;;AAwBA,SAAOX,OAAP;AAEA,CAvCD;;GAAMT,e;;AAyCN,eAAeA,eAAf","sourcesContent":["import axios from 'axios';\nimport { useContext } from 'react';\nimport { AuthContext } from '../context/AuthContext';\n\nconst useRefreshToken = () => {\n\n\tconst { userAuth, setUserAuth, logout } = useContext(AuthContext);\n\n\tconst baseURL = \"http://localhost:8080/api\";\n\tconst refreshURL = `${baseURL}/users/token/refresh`;\n\n\tconst config = {\n\t\theaders: {\n\t\t\t'Authorization': `Bearer ${userAuth.refreshToken}`\n\t\t}\n\t}\n\t\n\tconst refresh = async () => {\n\n\t\ttry {\n\t\t\t\n\t\t\tconst response = await axios.get(refreshURL, config);\n\t\t\t\n\t\t\twindow.localStorage.setItem(\"access_token\", response.data.access_token);\n\n\t\t\tsetUserAuth(prevState => ( {\n\t\t\t\tusername: prevState.username,\n\t\t\t\taccessToken: response.data.access_token,\n\t\t\t\trefreshToken: prevState.refreshToken\n\t\t\t}));\n\n\t\t\treturn response.data.access_token;\n\t\t\n\t\t} catch (error) {\n\t\t\tconsole.log(`Error: ${error.response.data.error_message}`);\n\t\t\tlogout();\n\t\t\tthrow error;\n\t\t\n\t\t}\n\t}\n\n\treturn refresh;\n\t\n}\n\nexport default useRefreshToken;"]},"metadata":{},"sourceType":"module"}